<div class="productos section">
  <p-toast></p-toast>

  <p-toolbar styleClass="mb-4 gap-2">

    <ng-template pTemplate="left">
      <button pButton pRipple label="New" icon="pi pi-plus" class="p-button-success mr-2" ></button>
    <button pButton pRipple label="Delete" icon="pi pi-trash" class="p-button-danger" (click)="deletedSelectedProducts()" [disabled]="!selectedProducts || !selectedProducts.length"></button> 
  </ng-template>

  <ng-template pTemplate="right">
    <div class="topbar-search" [class.topbar-search-active]="hidenSearch">
      <button (click)="showSearch()"  icon="pi pi-search" type="button" class="topbar-searchbutton p-button-text  text-color-secondary p-button-rounded flex-shrink-0 p-button p-component p-button-icon-only">
        <span class="p-button-icon pi pi-search" aria-hidden="true"></span>
      </button>

      <div class="search-input-wrapper">
        <span class="p-input-icon-right">
          <input #searchProduct type="text" pinputtext="" (keydown.enter)="productos.filterGlobal(searchProduct.value, 'contains')" placeholder="Buscar producto" class="p-inputtext p-component p-element">
          <i class="pi pi-search" (click)="hiddenSearch()"></i>
        </span>
        </div>
     </div>
  </ng-template>
  

  </p-toolbar>
 
  <p-table
    #productos
    [value]="data"
    styleClass="p-datatable-gridlines"
    [(selection)]="selectedProducts"
    [paginator]="true"
   [loading]="isLoading"
    [globalFilterFields]="['nombre', 'producto.nombre ', 'producto.sku ', 'status']"
    [rows]="8"
   class="productos__table"
  >

    


    <ng-template pTemplate="header" >
      <tr class="productos__tr productos__head">
        <th class="productos__th" style="width: 10%">
          <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
        </th>

        <th style="width: 40%" class="productos__th">
          <h4 class="productos__h4">Producto</h4>
        </th>

        <th style="width: 10%" class="productos__th">
          <h4 class="productos__h4">Sku</h4>
        </th>
        <th style="width: 10%" class="productos__th">
          <h4 class="productos__h4">Precio</h4>
        </th>
        <th style="width: 10%" class="productos__th">
          <h4 class="productos__h4">Stock</h4>
        </th>

        <th style="width: 10%" class="productos__th productos__th--status">
          <h4 class="productos__h4">Status</h4>
        </th>

        <th style="width: 10%" class="productos__th">
          <h4 class="productos__h4">Opciones</h4>
        </th>
      </tr>
    </ng-template>

    <ng-template  *ngIf="isLoading" pTemplate="loadingbody" > 
      <tr class="productos__tr productos__body">
        <td data-label="" class="productos__td">
          <p-skeleton></p-skeleton>
        </td>
        <td data-label="PRODUCTO" class="productos__td productos__td--producto">
      
          <p-skeleton></p-skeleton>
        
        </td>

        <td data-label="SKU" class="productos__td">
          <p-skeleton></p-skeleton>
        </td>

        <td data-label="PRECIO" class="productos__td">
          <p-skeleton></p-skeleton>
        </td>

        <td data-label="STOCK" class="productos__td ">
          <p-skeleton></p-skeleton>
        </td>

        <td data-label="STATUS" class="productos__td productos__td--status">
          <p-skeleton></p-skeleton>
        </td>

        <td data-label="OPCIONES" class="productos__td">
          <p-skeleton></p-skeleton>
        </td>
      </tr>
    </ng-template>
    

    <ng-template #datala pTemplate="body" let-producto >
      <tr class="productos__tr productos__body">
        <td data-label="" class="productos__td">
          <p-tableCheckbox class="productos__check"></p-tableCheckbox>
        </td>
        <td data-label="PRODUCTO" class="productos__td productos__td--producto">
          <img *ngIf="producto.images"
            class="productos__img shadow-4"
            loading="lazy"
            [src]="producto.images.src"
            [alt]="producto.images.alt"
          />
          <h5 class="productos__h5">{{ producto.nombre }}</h5>
        </td>

        <td data-label="SKU" class="productos__td">
          <p class="productos__p">
            {{ producto.sku }}
          </p>
        </td>

        <td data-label="PRECIO" class="productos__td">
          <p class="productos__p">${{ producto.precio }}</p>
        </td>

        <td data-label="STOCK" class="productos__td ">
          <p class="productos__p">
            {{ producto.stock }}
          </p>
        </td>

        <td data-label="STATUS" class="productos__td productos__td--status">
          <p-tag
            class="productos__status"
            [rounded]="true"
            severity="danger"
            *ngIf="producto.stock == 0"
          >
            Sin stocks
          </p-tag>
          <p-tag
            class="productos__status"
            [rounded]="true"
            severity="warning"
            *ngIf="producto.stock >= 1 && producto.stock <= 9"
          >
            Stock bajo
          </p-tag>
          <p-tag
            class="productos__status"
            [rounded]="true"
            severity="success"
            *ngIf="producto.stock >= 10"
          >
            Suficiente stock
          </p-tag>
        </td>

        <td data-label="OPCIONES" class="productos__td productos__td--opciones">
         
          <!-- <p-toast></p-toast>
          <p-menu #menu [model]="items" [popup]="true"></p-menu>
    
          <p-button icon="pi pi-ellipsis-v" type="button" (click)="menu.toggle($event)" styleClass="topbar-searchbutton p-button-text text-color-secondary p-button-rounded flex-shrink-0 p-button p-component p-button-icon-only">
         
          </p-button> -->
          
          <div class="card_menu card">
            <p-button icon="pi pi-ellipsis-v" type="button"   styleClass="topbar-searchbutton p-button-text text-color-secondary p-button-rounded flex-shrink-0 p-button p-component p-button-icon-only">
                
            </p-button>
          
          </div>

         
   
          <!-- <button
            pButton
            pRipple
            type="button"
            icon="pi pi-pencil"
            class="productos__btn p-button-rounded p-button-text"
            (click)="viewProduct(producto.id)"
          ></button>

          <p-button styleClass="p-button-rounded p-button-danger p-button-text p-button-raised">
            <i class="material-icons">add_a_photo</i>
          </p-button> -->

        </td>
      </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage">
      <tr>
          <td colspan="7">Producto no encontrado</td>
      </tr>
  </ng-template>
  
  </p-table>


</div>


