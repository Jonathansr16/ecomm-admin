<div class="order-table section" [ngSwitch]="statusData">
  

  <ng-template #data ngSwitchCase="success">

    <div class="order-search">
      <div class="order-search__left">
        <span class="order-search__content">
          <i class="order-search__icon order-search__icon-1 pi pi-search"></i>
          <input
            [(ngModel)]="searchTerm"
            name="searchText"
            class="order-search__input"
            type="text"
            pInputText
          />
          <i
            class="order-search__icon order-search__icon-2 pi pi-info-circle"
            pTooltip="Busca por # venta, producto o nombre de la persona que lo compro"
          ></i>
        </span>
      </div>
  
      <div class="order-search__right">
        <!-- <span class="order-search__span">{{ dataOrders?.length || 0 }} ventas</span> -->
        <button pripple class="caption__btn p-ripple p-element p-button p-component p-button-text"  type="button" style="background-color: var(--highlight-bg); color: var(--highlight-text-color)">Exportar Ordenes</button>

      </div>
    </div>

   
<!--       
      <div class="order__row">
        <div class="order__col">
          <h1 class="order__h1">Ordenes</h1>
        </div>
        <div class="order__col">
          <button pripple class="caption__btn p-ripple p-element p-button p-component p-button-text"  type="button" style="background-color: var(--highlight-bg); color: var(--highlight-text-color)">Exportar Productos</button>

        </div>
       
      
    </div> -->
    
    <div class="order-card" *ngFor="let order of dataOrders; let i = index">
      <div class="order-header">
        <div class="order-header__left">
          <!-- <p-checkbox [binary]="true" [value]="order" inputId="binary" (onChange)="handleCheckboxChange(order)"></p-checkbox> -->
          <h3 class="order__h3">{{ order.id }}</h3>
          <small class="order__separator">|</small>
          <span class="order__span">{{ order.date_created | date: 'short'  }}</span>
        </div>
        <div class="order-header__right">
          <span class="order__span">Status: 
            
            <small class="order__small" [ngClass]="{ 'order__completed': order.status === 'completed', 'order__failed': order.status === 'failed' || order.status === 'cancelled'  }">{{ order.status | uppercase }}</small></span>
          <small class="order__separator">|</small>
          <span class="order__h3"
            >{{ order.first_name }} {{ order.last_name }}</span
          >
        </div>
      </div>

      <div class="order-details">
        <div class="order-details__left">
          <div class="order-status">
            <span
              *ngIf="order.status === 'completed'"
              class="order-status__span order-status__completed"
            >
              {{ order.status }}
            </span>

            <span
              *ngIf="order.status === 'cancelled'"
              class="order-status__span order-status__failed"
            >
              {{ order.status }}
            </span>
          </div>
        </div>

        <div class="order-details__right">
          <button type="button" class="order__btn">Ver detalles</button>
        </div>
      </div>

        <ng-container *ngIf="order.product.length > 1; else moreOneProductView">
          
            
        <div class="order-menu">
            <p-button
            icon="pi pi-angle-down"
            type="button"
            styleClass="topbar-searchbutton p-button-text text-color-secondary p-button-rounded flex-shrink-0 p-button p-component p-button-icon-only"
            (onClick)="toggleAccordion(i)"
            >
          </p-button>

            <div class="order-menu__container" *ngIf="!isItemOpen(i)">
                <div class="order-menu__product">

                    <div class="order-menu__pictures">
                        <div class="order-menu__image order-menu__image--1">
                          <img
                            [src]="order.product[0].image.src"
                            class="order-menu__img"
                            alt=""
                          />
                        </div>
        
                        <div class="order-menu__image order-menu__image--2">
                          <img
                            [src]="order.product[1].image.src"
                            class="order-menu__img"
                            alt=""
                          />
                        </div>
                    </div>
                    <span class="order__span order__span--paquetes">Paquete de {{ order.product.length }} unidades</span>
                </div>

                <div class="order-menu__price">

                    <small class="order__small">${{order.total}}</small>
                </div>

            </div>

            <div class="order-menu__products" *ngIf="isItemOpen(i)">
    
                <div class="order-content order-content__products" *ngFor="let product of order.product">
                    <div class="order-content__left">
                        <div class="order-content__product">
                          <img
                            [src]="product.image.src"
                            class="order-content__img"
                            alt=""
                          />
            
                          <div class="order-content__details">
                            <a href="#" class="order__a"> {{ order.product[0].name }} </a>
                            <!-- <span class="order__span"
                              >SKU: {{product.sku }}
                            </span> -->
                          </div>
                        </div>
                      </div>
            
                      <div class="order-content__center">
                        <small class="order__small">SKU: {{ product.sku }}</small>
                      </div>
            
                      <div class="order-content__right">
                        <small class="order__small"> ${{ product.total }}</small>
                        <span class="order__span"> | </span>
                        <span class="order__span">
                          {{ product.quantity }} unidades</span
                        >
                      </div>
                </div>

            </div>

        </div>

        </ng-container>

        <ng-template #moreOneProductView>
            <div class="order-content">
          <div class="order-content__left">
            <div class="order-content__product">
              <img
                [src]="order.product[0].image.src"
                class="order-content__img"
                alt=""
              />

              <div class="order-content__details">
                <a  href="#" class="order__a"> {{ order.product.length > 0 ? order.product[0].name : "Sin datos del producto"  }} </a>
               
              </div>
            </div>
          </div>

          <div class="order-content__center">
            <small class="order__small">SKU: {{ order.product[0].sku }}
            
            </small>
          </div>

          <div class="order-content__right">
            <small class="order__small"> ${{ order.total }}</small>
            <span class="order__span"> | </span>
            <span class="order__span">
              {{ order.product[0].quantity }} unidades</span
            >
          </div>
        </div>
        </ng-template>
      </div>
  
  </ng-template>

  <ng-template #dataLoading ngSwitchCase="loading">
    <app-loading-table></app-loading-table>
  </ng-template>

  <ng-template #dataError ngSwitchCase="error">
    <app-message
      [titleError]="titleError"
      [DetailError]="detailsError"
    ></app-message>
  </ng-template>
</div>
